# trocopter

Данный репозиторий содержит описание работы кода команды Трокоптер.
Алгоритм мы разделили на несколько частей: первый облет и второй облет.

Во время первого облета требовалось:
1) Пролететь по заданным координатам
2) Распознать цвет метки на координате
3) Просигнализировать светодиодной лентой, если цвет желтый или красный
4) "Запомнить", где цвет желтый или красный, чтобы во время второго облета вернуться на эту точку.

Во время второго облета требовалось:
1) Совершить облет по "запомненным" координатам
2) Просканировать QR метки на эих координатах
3) Просигнализировать лентой, если заражение подтвердилось, и вывести результат в терминал 

Начнем с первого облетета.
1) Для полета по координатам мы используем функцию navigate() с frame_id = 'aruco_map'
```python
navigate(x=0.295, y=0.885, z=0.5, speed=0.2, frame_id='aruco_map')
rospy.sleep(8)
```
Таким образом коптер пролетает по всем координатам.

2) Распознавать цвет мы начинаем когда коптер прилетает в очередную точку. Для того, чтобы в конкретный момент распознавать то, что нам надо, мы используем следующую конструкцию
```python
if first_fly and check != '0':
```
Переменная first_fly равна True во время первого облета, и False во время второго. Таким образом, во время первого полета мы распознаем цвета, а во время второго QR коды, используя один callback.
Переменная check принимает значение, соответствующее номеру точки
```python
navigate(x=0.295, y=0.295, z=0.5, speed=0.2, frame_id='aruco_map')
rospy.sleep(8)
#Запускаем распознование
check = '1'
rospy.sleep(1)
#Останавливаем распознование
check = '0'
```
Номера точек соотносятся с координатами в словаре PATIENTS
```python
PATIENTS = {'1': [0.295, 0.295], '2': [0.885, 0.295], '3': [0.295, 0.885],
            '4': [0.885, 0.885], '5': [0.295, 1.475], '6': [0.885, 1.475],
            '7': [0.295, 2.065], '8': [0.885, 2.065], '9': [0.59, 2.655]}
```
Таким образом, когда коптер находится на какой-либо координате, распознавалка начинает работать.
